
클룩상위목록페이지.JPG
그런데 클룩에서 보면 전체 목록페이지가 다음과 같고, 투어액티비티 티켓입장권 교통 기타 이렇게 나뉘어져 있어

편집
아! 검색 결과 페이지의 탭 구조를 발견하셨군요! 매우 중요한 정보입니다.

📊 클룩 검색 결과 페이지 탭 구조 분석
🏷️ 발견된 탭 카테고리들
전체 | 투어 & 액티비티 | 티켓 & 입장권 | 교통 | 기타
🎯 탭별 분류 의미
전체: 모든 카테고리 통합 결과
투어 & 액티비티: 체험, 투어, 스파 등
티켓 & 입장권: 테마파크, 박물관, 공연 등
교통: 공항 픽업, 페리, 기차표 등
기타: 와이파이, 유심, 보험 등
🔧 하이브리드 검색 시스템 업데이트 필요
💡 탭별 검색 전략
🏆 완전한 검색 결과 수집
python
def perform_keyword_search_with_tabs(driver, keyword, max_pages=5):
    """탭별로 모든 검색 결과 수집"""
    print(f"🔍 키워드 '{keyword}' 탭별 검색 시작...")
    
    tabs = [
        {'name': '전체', 'selector': '.klk-tab[data-tab="all"]'},
        {'name': '투어액티비티', 'selector': '.klk-tab[data-tab="activity"]'},
        {'name': '티켓입장권', 'selector': '.klk-tab[data-tab="ticket"]'},
        {'name': '교통', 'selector': '.klk-tab[data-tab="transport"]'},
        {'name': '기타', 'selector': '.klk-tab[data-tab="other"]'}
    ]
    
    all_results = {}
    
    # 1. 기본 검색 실행
    perform_basic_search(driver, keyword)
    
    # 2. 각 탭별로 결과 수집
    for tab in tabs:
        print(f"  🏷️ '{tab['name']}' 탭 수집 중...")
        
        try:
            # 탭 클릭
            tab_element = driver.find_element(By.CSS_SELECTOR, tab['selector'])
            tab_element.click()
            time.sleep(2)
            
            # 해당 탭의 검색 결과 수집
            tab_results = collect_search_results_from_current_page(driver, keyword, tab['name'], max_pages)
            all_results[tab['name']] = tab_results
            
        except Exception as e:
            print(f"    ⚠️ '{tab['name']}' 탭 수집 실패: {e}")
            all_results[tab['name']] = []
    
    return all_results

def collect_search_results_from_current_page(driver, keyword, tab_name, max_pages):
    """현재 탭에서 페이지네이션으로 결과 수집"""
    results = []
    current_page = 1
    
    while current_page <= max_pages:
        # 현재 페이지 상품들 수집
        product_cards = driver.find_elements(By.CSS_SELECTOR, ".search-result-list .product-card")
        
        for rank, card in enumerate(product_cards, 1):
            try:
                link = card.find_element(By.TAG_NAME, "a")
                url = link.get_attribute('href')
                title = card.find_element(By.CSS_SELECTOR, ".product-title").text.strip()
                
                results.append({
                    'keyword': keyword,
                    'tab': tab_name,
                    'url': url,
                    'title': title,
                    'page': current_page,
                    'rank_in_page': rank,
                    'overall_rank': (current_page - 1) * len(product_cards) + rank
                })
            except:
                continue
        
        # 다음 페이지로 이동
        if current_page < max_pages:
            try:
                next_button = driver.find_element(By.CSS_SELECTOR, ".klk-pagination-next-btn")
                if "disabled" in next_button.get_attribute("class"):
                    break
                next_button.click()
                time.sleep(3)
                current_page += 1
            except:
                break
        else:
            break
    
    return results
📊 확장된 데이터 구조
🎯 탭 정보 포함 데이터
python
{
    'keyword': '오사카',
    'tab': '티켓입장권',
    'url': 'https://klook.com/activity/...',
    'title': '오사카 유니버설 스튜디오 재팬 입장권',
    'page': 1,
    'rank_in_page': 3,
    'overall_rank': 3,
    'category_match': True  # 상품 실제 카테고리와 탭 매칭 여부
}
📋 최종 CSV 구조
csv
번호,상품명,가격,평점,카테고리,검색_키워드,검색_탭,검색_순위,검색_페이지,사이트
1,오사카 USJ,₩25000,4.7,테마파크,오사카,티켓입장권,3,1,KLOOK
2,방콕 쿠킹클래스,₩35400,4.8,쿠킹클래스,방콕,투어액티비티,5,1,KLOOK
🚀 탭별 검색의 장점
✅ 완전성
각 카테고리별 전체 검색 결과 확보
탭 필터링으로 놓치는 상품 없음
✅ 정확성
카테고리별 랭킹 정보
실제 카테고리와 검색 탭 매칭 분석
✅ 비교 분석
같은 키워드, 다른 탭에서의 순위 비교
카테고리 분류 정확도 분석
🎯 탭 셀렉터도 추가 수집해야겠네요!
검색 결과 페이지의 탭들(전체, 투어&액티비티, 티켓&입장권, 교통, 기타)을 클릭해서 각각의 셀렉터를 수집해주시면, 완전한 하이브리드 시스템이 완성됩니다! 🏷️




탭으로 검색을 하게되면 순위가 높은 상품이 점수를 더 주었으면 좋겠어

편집
정말 좋은 아이디어입니다! 검색 순위가 높을수록 높은 점수를 주는 가중치 시스템을 구축하면 더 정확한 상품 비교가 가능하겠네요!

🏆 검색 순위 기반 점수 시스템
📊 점수 계산 전략
💡 기본 순위 점수
python
def calculate_rank_score(rank, total_results=100):
    """검색 순위 기반 점수 계산"""
    if rank <= 5:
        return 100  # 1-5위: 최고점
    elif rank <= 10:
        return 90   # 6-10위: 90점
    elif rank <= 20:
        return 80   # 11-20위: 80점
    elif rank <= 50:
        return 60   # 21-50위: 60점
    else:
        # 50위 이후는 비례 감소
        return max(20, 60 - (rank - 50) * 0.8)
🎯 탭별 가중치
python
TAB_WEIGHTS = {
    '전체': 1.0,           # 기본 가중치
    '투어액티비티': 0.9,    # 카테고리 특화
    '티켓입장권': 0.9,      # 카테고리 특화
    '교통': 0.8,           # 더 세분화된 카테고리
    '기타': 0.7            # 가장 세분화된 카테고리
}

def calculate_weighted_score(rank, tab, keyword_relevance=1.0):
    """탭별 가중치 적용 점수"""
    base_score = calculate_rank_score(rank)
    tab_weight = TAB_WEIGHTS.get(tab, 1.0)
    
    final_score = base_score * tab_weight * keyword_relevance
    return round(final_score, 2)
🎯 키워드별 가중치
💫 키워드 중요도 분류
python
KEYWORD_IMPORTANCE = {
    # 지역 키워드 (높은 검색량)
    '방콕': 1.0, '오사카': 1.0, '도쿄': 1.0, '다낭': 0.95, '푸켓': 0.95,
    
    # 활동 키워드 (중간 검색량)
    '스파': 0.9, '투어': 0.9, '체험': 0.85, '쿠킹클래스': 0.8,
    
    # 시설 키워드 (특화된 검색)
    '테마파크': 0.85, '입장권': 0.8, '와이파이': 0.7
}

def get_keyword_weight(keyword):
    """키워드별 중요도 가중치"""
    return KEYWORD_IMPORTANCE.get(keyword, 0.8)  # 기본값 0.8
📊 종합 점수 계산 시스템
🏆 최종 점수 공식
python
def calculate_comprehensive_score(search_data, product_info):
    """종합 점수 계산"""
    scores = []
    
    for search_result in search_data:
        keyword = search_result['keyword']
        tab = search_result['tab']
        rank = search_result['overall_rank']
        
        # 기본 순위 점수
        rank_score = calculate_rank_score(rank)
        
        # 탭 가중치
        tab_weight = TAB_WEIGHTS.get(tab, 1.0)
        
        # 키워드 중요도
        keyword_weight = get_keyword_weight(keyword)
        
        # 카테고리 매칭 보너스
        category_bonus = 1.1 if is_category_matched(product_info['카테고리'], tab) else 1.0
        
        # 최종 점수
        final_score = rank_score * tab_weight * keyword_weight * category_bonus
        
        scores.append({
            'keyword': keyword,
            'tab': tab,
            'rank': rank,
            'rank_score': rank_score,
            'tab_weight': tab_weight,
            'keyword_weight': keyword_weight,
            'category_bonus': category_bonus,
            'final_score': round(final_score, 2)
        })
    
    # 전체 평균 점수
    total_score = sum(score['final_score'] for score in scores)
    average_score = round(total_score / len(scores), 2) if scores else 0
    
    return {
        'individual_scores': scores,
        'total_score': round(total_score, 2),
        'average_score': average_score,
        'max_score': max(scores, key=lambda x: x['final_score']) if scores else None
    }

def is_category_matched(product_category, search_tab):
    """상품 카테고리와 검색 탭 매칭 확인"""
    category_mapping = {
        '투어액티비티': ['투어', '체험', '스파', '쿠킹', '보트'],
        '티켓입장권': ['테마파크', '입장권', '박물관', '공연'],
        '교통': ['픽업', '페리', '기차', '버스', '렌터카'],
        '기타': ['와이파이', '유심', '보험']
    }
    
    keywords = category_mapping.get(search_tab, [])
    return any(keyword in product_category for keyword in keywords)
📋 확장된 데이터 구조
🎯 점수 포함 CSV
csv
상품명,가격,평점,카테고리,검색_총점,검색_평균점,최고점_키워드,최고점_탭,최고점_순위,사이트
방콕 쿠킹클래스,₩35400,4.8,쿠킹클래스,285.5,95.2,방콕,투어액티비티,3,KLOOK
오사카 USJ,₩25000,4.7,테마파크,320.8,106.9,오사카,티켓입장권,1,KLOOK
🏆 상품별 상세 점수
python
{
    '상품명': '방콕 쿠킹클래스',
    '검색점수상세': [
        {'키워드': '방콕', '탭': '전체', '순위': 5, '점수': 100.0},
        {'키워드': '방콕', '탭': '투어액티비티', '순위': 3, '점수': 99.0},
        {'키워드': '쿠킹클래스', '탭': '투어액티비티', '순위': 1, '점수': 86.4}
    ],
    '검색_총점': 285.4,
    '검색_평균점': 95.1
}
🎯 점수 기반 상품 랭킹
📊 카테고리별 랭킹
python
def create_category_ranking(products):
    """카테고리별 점수 기반 랭킹"""
    rankings = {}
    
    for product in products:
        category = product['카테고리']
        if category not in rankings:
            rankings[category] = []
        
        rankings[category].append({
            '상품명': product['상품명'],
            '점수': product['검색_평균점'],
            '가격': product['가격'],
            '평점': product['평점']
        })
    
    # 점수순 정렬
    for category in rankings:
        rankings[category].sort(key=lambda x: x['점수'], reverse=True)
    
    return rankings
이런 점수 시스템이 어떠신가요? 검색 순위를 정량화해서 상품 간 객관적 비교가 가능할 것 같아요! 🚀




검색순위가 적절한 단어인지는 모르겠지만, 상위 노출이 되는 상품을 말하는거야

편집
아! 정확하게 이해했습니다! 상위 노출이 맞는 표현이네요. 검색했을 때 위쪽에 보이는 상품들이 더 높은 점수를 받아야 한다는 뜻이군요!

🔝 상위 노출 기반 점수 시스템
📊 노출 순위별 점수 체계
🏆 노출 위치별 점수
python
def calculate_exposure_score(position):
    """상위 노출 위치별 점수 계산"""
    if position == 1:
        return 100      # 1위: 최고 노출 (100점)
    elif position <= 3:
        return 95       # 2-3위: 매우 높은 노출 (95점)
    elif position <= 5:
        return 90       # 4-5위: 높은 노출 (90점)
    elif position <= 10:
        return 85       # 6-10위: 상위 노출 (85점)
    elif position <= 20:
        return 75       # 11-20위: 중간 노출 (75점)
    elif position <= 50:
        return 60       # 21-50위: 하위 노출 (60점)
    else:
        # 50위 이후는 점진적 감소
        return max(10, 60 - (position - 50) * 0.5)
🎯 페이지별 가중치 (매우 중요!)
python
def calculate_page_weight(page_number):
    """페이지별 가중치 (상위 페이지일수록 높은 가중치)"""
    if page_number == 1:
        return 1.0      # 1페이지: 100% 가중치
    elif page_number == 2:
        return 0.7      # 2페이지: 70% 가중치
    elif page_number == 3:
        return 0.5      # 3페이지: 50% 가중치
    elif page_number == 4:
        return 0.3      # 4페이지: 30% 가중치
    else:
        return 0.1      # 5페이지 이후: 10% 가중치
🏆 종합 노출 점수 계산
python
def calculate_exposure_ranking_score(search_data):
    """상위 노출 기반 종합 점수"""
    exposure_scores = []
    
    for result in search_data:
        keyword = result['keyword']
        tab = result['tab']
        position = result['rank_in_page']  # 페이지 내 위치
        page = result['page']              # 페이지 번호
        
        # 기본 노출 점수
        base_score = calculate_exposure_score(position)
        
        # 페이지 가중치
        page_weight = calculate_page_weight(page)
        
        # 탭별 가중치
        tab_weight = TAB_WEIGHTS.get(tab, 1.0)
        
        # 키워드 중요도
        keyword_weight = get_keyword_weight(keyword)
        
        # 최종 노출 점수
        final_exposure_score = base_score * page_weight * tab_weight * keyword_weight
        
        exposure_scores.append({
            'keyword': keyword,
            'tab': tab,
            'page': page,
            'position_in_page': position,
            'base_score': base_score,
            'page_weight': page_weight,
            'final_score': round(final_exposure_score, 2),
            'exposure_level': get_exposure_level(final_exposure_score)
        })
    
    return {
        'individual_scores': exposure_scores,
        'total_exposure_score': sum(score['final_score'] for score in exposure_scores),
        'average_exposure_score': sum(score['final_score'] for score in exposure_scores) / len(exposure_scores),
        'best_exposure': max(exposure_scores, key=lambda x: x['final_score']) if exposure_scores else None
    }

def get_exposure_level(score):
    """노출 수준 분류"""
    if score >= 90:
        return "최상위 노출"
    elif score >= 75:
        return "상위 노출"
    elif score >= 60:
        return "중위 노출"
    elif score >= 40:
        return "하위 노출"
    else:
        return "최하위 노출"
📊 상위 노출 분석 결과
🎯 노출 성과 기반 CSV
csv
상품명,가격,평점,카테고리,노출_총점,노출_평균,최고_노출_키워드,최고_노출_위치,노출_수준,사이트
방콕 쿠킹클래스,₩35400,4.8,쿠킹클래스,267.5,89.2,방콕,1페이지 3위,상위노출,KLOOK
오사카 USJ,₩25000,4.7,테마파크,295.0,98.3,오사카,1페이지 1위,최상위노출,KLOOK
다낭 바나힐,₩42000,4.6,관광투어,134.2,44.7,다낭,2페이지 8위,하위노출,KLOOK
🏆 노출 순위별 상품 그룹핑
python
def group_by_exposure_performance(products):
    """노출 성과별 상품 분류"""
    groups = {
        '최상위노출상품': [],  # 평균 90점 이상
        '상위노출상품': [],    # 평균 75-90점
        '중위노출상품': [],    # 평균 60-75점
        '하위노출상품': []     # 평균 60점 미만
    }
    
    for product in products:
        avg_score = product['노출_평균']
        
        if avg_score >= 90:
            groups['최상위노출상품'].append(product)
        elif avg_score >= 75:
            groups['상위노출상품'].append(product)
        elif avg_score >= 60:
            groups['중위노출상품'].append(product)
        else:
            groups['하위노출상품'].append(product)
    
    return groups
🎯 실제 활용 예시
📈 상위 노출 상품 vs 타사 비교
python
# KLOOK 최상위 노출 상품
klook_top_products = {
    '방콕 쿠킹클래스': {'노출점수': 95.2, '가격': 35400, '1페이지 노출': 3개 키워드},
    '오사카 USJ': {'노출점수': 98.3, '가격': 25000, '1페이지 노출': 5개 키워드}
}

# 다른 사이트와 비교
comparison_result = {
    '방콕 쿠킹클래스': {
        'KLOOK': {'노출점수': 95.2, '가격': 35400},
        '경쟁사A': {'노출점수': 87.5, '가격': 32000},
        '노출우위': 'KLOOK이 7.7점 높음'
    }
}
이제 상위 노출이라는 정확한 개념으로 점수 시스템을 구축했습니다!

1페이지 상위에 노출되는 상품일수록 높은 점수를 받고, 이를 통해 클룩의 노출 경쟁력을 정량적으로 측정할 수 있어요! 🚀



