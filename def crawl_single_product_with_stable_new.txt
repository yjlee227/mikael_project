def crawl_single_product_with_stable_new_tab(driver, product_url, product_number, city_name,
                                             continent, country, page_num):
      """ğŸ›¡ï¸ ì„¸ì…˜ ì•ˆì •ì„±ì´ ê°•í™”ëœ ìƒˆ íƒ­ í¬ë¡¤ë§ í•¨ìˆ˜ (ê¸°ì¡´ ì½”ë“œ 100% í˜¸í™˜)"""
      main_tab = driver.current_window_handle
      new_tab = None

      try:
          # ğŸ”¹ 1ë‹¨ê³„: ì„¸ì…˜ ìœ íš¨ì„± ì‚¬ì „ ê²€ì¦
          try:
              driver.current_url  # ì„¸ì…˜ ìƒíƒœ í™•ì¸
              driver.title       # ì¶”ê°€ ê²€ì¦
          except Exception as e:
              print(f"      ğŸš¨ ì„¸ì…˜ ë¬´íš¨: {e}")
              return None

          # ğŸ”¹ 2ë‹¨ê³„: ì•ˆì „í•œ ìƒˆ íƒ­ ìƒì„± (3íšŒ ì‹œë„)
          for tab_attempt in range(3):
              try:
                  driver.execute_script("window.open('');")
                  all_tabs = driver.window_handles

                  if len(all_tabs) > 1:  # ê°œì„ : ë‹¨ìˆœí™”
                      new_tab = all_tabs[-1]
                      driver.switch_to.window(new_tab)
                      print(f"      âœ… ìƒˆ íƒ­ ìƒì„± ì„±ê³µ (ì‹œë„ {tab_attempt + 1})")
                      break
                  else:
                      print(f"      âš ï¸ ìƒˆ íƒ­ ìƒì„± ì‹¤íŒ¨ (ì‹œë„ {tab_attempt + 1})")

              except Exception as e:
                  print(f"      âŒ íƒ­ ìƒì„± ì˜¤ë¥˜ {tab_attempt + 1}: {e}")
                  if tab_attempt < 2:
                      time.sleep(1)
                      continue
                  else:
                      return None

          if not new_tab:
              print(f"      ğŸš¨ ìƒˆ íƒ­ ìƒì„± ìµœì¢… ì‹¤íŒ¨")
              return None

          # ğŸ”¹ 3ë‹¨ê³„: ìƒí’ˆ í˜ì´ì§€ ë¡œë“œ (ì•ˆì •ì„± ê°•í™”)
          load_success = False
          for load_attempt in range(3):
              try:
                  driver.get(product_url)

                  # í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ ëŒ€ê¸° (ê¸°ì¡´ ì‹œìŠ¤í…œê³¼ í˜¸í™˜)
                  timeout = CONFIG.get("PAGE_LOAD_TIMEOUT", 6)
                  if not smart_wait_for_page_load(driver, max_wait=timeout):
                      print(f"      âš ï¸ í˜ì´ì§€ ë¡œë”© ì‹œê°„ ì´ˆê³¼, ê³„ì† ì§„í–‰")

                  # í˜ì´ì§€ ì•ˆì •í™” ëŒ€ê¸° ì¶”ê°€
                  time.sleep(random.uniform(1, 2))

                  # ì„¸ì…˜ ìœ íš¨ì„± ì¬í™•ì¸ (offers í¬í•¨)
                  current_url = driver.current_url
                  if (product_url in current_url or
                      "products" in current_url or
                      "offers" in current_url):
                      load_success = True
                      print(f"      âœ… í˜ì´ì§€ ë¡œë“œ ì„±ê³µ (ì‹œë„ {load_attempt + 1})")
                      break
                  else:
                      print(f"      âš ï¸ í˜ì´ì§€ ë¡œë“œ ì˜ì‹¬ (ì‹œë„ {load_attempt + 1}): {current_url}")

              except Exception as e:
                  print(f"      âŒ í˜ì´ì§€ ë¡œë“œ ì˜¤ë¥˜ {load_attempt + 1}: {e}")
                  if load_attempt < 2:
                      time.sleep(2)
                      continue

          if not load_success:
              print(f"      ğŸš¨ í˜ì´ì§€ ë¡œë“œ ìµœì¢… ì‹¤íŒ¨")
              return None

          # ğŸ”¹ 4ë‹¨ê³„: ë°ì´í„° ìˆ˜ì§‘ (ê¸°ì¡´ ë¡œì§ 100% í™œìš©)
          try:
              # URL íƒ€ì… íŒë³„ (ê¸°ì¡´ê³¼ ë™ì¼)
              url_type = "Product" if "/products/" in product_url else "Offer"

              # ì •ë³´ ìˆ˜ì§‘ (ê¸°ì¡´ í•¨ìˆ˜ë“¤ ê·¸ëŒ€ë¡œ ì‚¬ìš©)
              product_name = get_product_name(driver, url_type)
              price_raw = get_price(driver)
              price_clean = clean_price(price_raw)
              rating_raw = get_rating(driver)
              rating_clean = clean_rating(rating_raw)
              review_count = get_review_count(driver)
              language = get_language(driver)

              # ë„ì‹œID ìƒì„± (ê¸°ì¡´ê³¼ ë™ì¼)
              city_code = get_city_code(city_name)
              city_id = f"{city_code}_{product_number}"

              # ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ (ê¸°ì¡´ ì‹œìŠ¤í…œ í˜¸í™˜)
              if CONFIG.get("SAVE_IMAGES", False):
                  img_info = download_image(driver, product_name, city_name, product_number)
              else:
                  img_info = {
                      'filename': '', 'relative_path': '', 'path': '',
                      'status': 'skipped', 'size': 0
                  }

              print(f"      âœ… ë°ì´í„° ìˆ˜ì§‘ ì™„ë£Œ: {product_name[:30]}...")

          except Exception as e:
              print(f"      âŒ ë°ì´í„° ìˆ˜ì§‘ ì‹¤íŒ¨: {e}")
              return None

          # ğŸ”¹ 5ë‹¨ê³„: ê²°ê³¼ ë°ì´í„° ìƒì„± (ê¸°ì¡´ êµ¬ì¡° 100% ìœ ì§€)
          result = {
              'ë²ˆí˜¸': product_number,
              'ë„ì‹œID': city_id,
              'í˜ì´ì§€': page_num,
              'ëŒ€ë¥™': continent,
              'êµ­ê°€': country,
              'ë„ì‹œ': city_name,
              'ê³µí•­ì½”ë“œ': city_code,
              'ìƒí’ˆíƒ€ì…': url_type,
              'ìƒí’ˆëª…': product_name,
              'ê°€ê²©_ì›ë³¸': price_raw,
              'ê°€ê²©_ì •ì œ': price_clean,
              'í‰ì _ì›ë³¸': rating_raw,
              'í‰ì _ì •ì œ': rating_clean,
              'ë¦¬ë·°ìˆ˜': review_count,
              'ì–¸ì–´': language,
              'ì´ë¯¸ì§€_íŒŒì¼ëª…': img_info.get('filename', ''),
              'ì´ë¯¸ì§€_ìƒëŒ€ê²½ë¡œ': img_info.get('relative_path', ''),
              'ì´ë¯¸ì§€_ì „ì²´ê²½ë¡œ': img_info.get('path', ''),
              'ì´ë¯¸ì§€_ìƒíƒœ': img_info.get('status', ''),
              'ì´ë¯¸ì§€_í¬ê¸°': img_info.get('size', 0),
              'URL': product_url,
              'ìˆ˜ì§‘_ì‹œê°„': time.strftime('%Y-%m-%d %H:%M:%S'),
              'ìƒíƒœ': 'ì™„ì „ìˆ˜ì§‘'
          }

          return result

      except Exception as e:
          print(f"      ğŸš¨ í¬ë¡¤ë§ ì¹˜ëª…ì  ì˜¤ë¥˜: {e}")
          return None

      finally:
          # ğŸ”¹ 6ë‹¨ê³„: ì•ˆì „í•œ íƒ­ ì •ë¦¬ ë° ë©”ì¸ íƒ­ ë³µê·€
          try:
              if new_tab:
                  # ìƒˆ íƒ­ì´ ì—¬ì „íˆ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
                  current_tabs = driver.window_handles
                  if new_tab in current_tabs:
                      try:
                          driver.switch_to.window(new_tab)
                          driver.close()
                          print(f"      ğŸ—‘ï¸ ìƒˆ íƒ­ ì •ë¦¬ ì™„ë£Œ")
                      except Exception:
                          print(f"      âš ï¸ ìƒˆ íƒ­ ì •ë¦¬ ì¤‘ ì˜¤ë¥˜ (ë¬´ì‹œ)")

              # ë©”ì¸ íƒ­ìœ¼ë¡œ ì•ˆì „ ë³µê·€
              if main_tab in driver.window_handles:
                  driver.switch_to.window(main_tab)
                  print(f"      ğŸ”™ ë©”ì¸ íƒ­ ë³µê·€ ì™„ë£Œ")
              else:
                  # ë©”ì¸ íƒ­ì´ ì—†ìœ¼ë©´ ì²« ë²ˆì§¸ íƒ­ìœ¼ë¡œ
                  remaining_tabs = driver.window_handles
                  if remaining_tabs:
                      driver.switch_to.window(remaining_tabs[0])
                      print(f"      ğŸ”„ ì²« ë²ˆì§¸ íƒ­ìœ¼ë¡œ ë³µê·€")

              # ë©”ëª¨ë¦¬ ì •ë¦¬ë¥¼ ìœ„í•œ ì§§ì€ ëŒ€ê¸° (ê¸°ì¡´ ì‹œìŠ¤í…œê³¼ í˜¸í™˜)
              time.sleep(0.5)

          except Exception as cleanup_error:
              print(f"      âš ï¸ íƒ­ ì •ë¦¬ ì¤‘ ì˜¤ë¥˜: {cleanup_error}")
              # ì •ë¦¬ ì‹¤íŒ¨í•´ë„ ê³„ì† ì§„í–‰ (ê¸°ì¡´ ë™ì‘ ìœ ì§€)